(function(){"use strict";$(function(){function r(){var t=localStorage.getItem("pixiImage"),n=localStorage.getItem("pixiPos"),r=localStorage.getItem("pixiOpacity")||1;e.css({"background-repeat":"no-repeat","background-image":"url("+t+")","background-position":n,opacity:r}),e.addClass("hasItem")}function o(t){var n=t.clientX,r=t.clientY;n<i&&r<s&&(e.css("background-position",""+n+"px "+r+"px"),localStorage.setItem("pixiPos",""+n+"px "+r+"px"),e.css("cursor","move"))}if(!window.File&&!window.FileReader&&!window.FileList&&!window.Blob){alert("The File APIs are not fully supported in this browser.");return}$("body").find("#pixiOverlay").length||$("body").append('<div id="pixiOverlay" style="height:'+$(document).height()+'px"></div>');var e=$("#pixiOverlay");localStorage.getItem("pixiImage")&&r(),e.on("dragover",function(t){t.stopPropagation(),t.preventDefault();var n=t.originalEvent.dataTransfer;n.dropEffect="copy",e.addClass("pixiOver")}),e.on("dragleave",function(t){e.removeClass("pixiOver")}),e.on("drop",function(t){t.stopPropagation(),t.preventDefault();var n=t.originalEvent.dataTransfer,i=n.files;e.removeClass("pixiOver");var s=new FileReader;s.readAsDataURL(i[0]),s.onload=function(){localStorage.setItem("pixiImage",this.result),r()}});var t=!1,n=!1;$("body #pixiOverlay")&&(e.on("mousedown",function(e){t=!0}),e.on("mousemove",function(e){$("#pixiOverlay").hasClass("hasItem")&&t&&n&&$("#pixiOverlay").is(":visible")&&o(e)}),e.on("mouseup",function(n){t=!1,e.css("cursor","default")}));var i=$(window).width(),s=$(window).height();$(document).keydown(function(e){var t=parseInt($("#pixiOverlay").css("background-position").split(" ")[0].replace("px","")),r=parseInt($("#pixiOverlay").css("background-position").split(" ")[1].replace("px","")),i=0,s=e.keyCode||e.which,o={left:37,up:38,right:39,down:40,grid:71,zindex:90,shift:16,see:80,opacity:[48,49,50,51,52,53,54,55,56,57]};console.log(s);switch(s){case o.left:t--,$("#pixiOverlay").css("background-position",""+t+"px "+r+"px");break;case o.up:r--,$("#pixiOverlay").css("background-position",""+t+"px "+r+"px");break;case o.right:t++,$("#pixiOverlay").css("background-position",""+t+"px "+r+"px");break;case o.down:r++,$("#pixiOverlay").css("background-position",""+t+"px "+r+"px");break;case o.grid:$("#pixiOverlay").toggleClass("pixiToggle");break;case o.zindex:$("#pixiOverlay").toggleClass("lowZindex");break;case o.shift:n=!0;break;case o.see:$("#pixiOverlay").toggleClass("pointerDisable");break;default:s>=48&&s<=57&&$.each(o.opacity,function(e,t){o.opacity[e]===s&&(i=e/10||1,$("#pixiOverlay").css("opacity",i),localStorage.setItem("pixiOpacity",i))})}localStorage.setItem("pixiPos",""+t+"px "+r+"px")}),$(document).keyup(function(e){var t=e.keyCode||e.which;t==16&&(n=!1)})})})()